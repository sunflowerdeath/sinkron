import { LoroDoc } from "loro-crdt"
import { Base64 } from "js-base64"

const snapshot = "bG9ybwAAAAAAAAAAAAAAAK+fc78AA+8DAABMT1JPAAQiTRhgQIK0AwAA+loC29/O6L2r0tNnOMf35ey/nMj0vwE0AAwAZ6dJW90Tr9sAAAAAAAgACAEQAduvE91bSadnAQEAAAAAAAUBAAABAAYBBAECAAAFBHRleHQADgEEAgEAAgEAAgEFAgEIAAkISGVsbG9BYSBTAIQICA8XDwRJBFMA+m/crNGs++NE18d7mf3jIOm/FF2xSOwSfLEGAwMBAwEBBgMTAQIDAQIDAQIDAQEKAaLNqFRZtQqLNqEAAS4Cos8ABgEAAwAIAAYBBAECAAAFBHRleHQAEwEEAggABQM6HgQYAggFBAEGBgMAEwZBYSBBYSADQWEgA0FhIANBYSDvAHUXFwMpAwEwnAAEjAAMpADPAQEDBQECAwEoAqFPDwEE/gMPAQQCAQADAbgBAgEFAgEDAARvAIQaGgMyAwElAwsBDG8AEQH6AD8BNAFkAAwa0GQAVgIAdnYE0wH1CDaUusXFxN2EvrEBNtzZxua6/7ii1wE2/gHBOgAMALF8EuxIsV0U8wFkAwgDARsCjQAEnQARAQEAHw6LAAQE/gEbEO4AB1kASAMDAw5ZAATxAQFYAC8BClkADB8iWQAHhAYGDxcSBU8EsgAMrgEEwgD1AAMDAwMBBAEBCAMZAQIBAwMA+w0BCgSizaiUGcUSgziiUGcUcAEuA6EABgEABAAKWAL4BhIBBAIKAAYBOgYYAR4CCgUCCgMAFFACBAwAClQBXxUVBiwGVAEGHzL7AAT3BBABBAIEAAQDvgEGAgQFAgQDAAhfAIG/6SDj/Zl7x7MBZAYFCQIpA1IBBPEABBEB+wcDAQEEAQMBAgEIAZ6AAQoABgEAAQAE2wARD24ATwMDChJtAAt1BgYDEQMBJm0ABGUABHYBA7UCPwoBntcABAQrAhsu0gEH0QCECQkPFw8FTwTRAARcAARsAAThAA/SAQjvoU8oM+n1Bn0+oM+n1BDSAQcRENIBXwQBOggY0AEMB6AAjBgYAzIDARsCoAACywIfNPkABAQTBBrKrwOhDADXROP7rNGs3MsBAiUDBPIABGIAAloADyUDHQdZAIwDAxUUFQZVBFkABEsBBFsBEQZUAYkFAQEEAgYDGygD8gcCARAFoM+ndHnc7o87ndHnc7o4ASgEgwU7BQAMUAL/CBQBBAIMAAYFNBgSBhgCDAUEAQYKAwAbhAUAB9UCB7EASBgYAy8KAQShAAIKAR8uZAEMKcQBXgLwFAAWAGkABQF0AdgBCQJiArsCXQO8AykEjQQtBYcF4AWRBhEAAAAAAEcmhCABAAAABQAAAAIAZnIBDADXROP7rNGs3AAAABi9GZA8zAMAANwAAABMT1JPAAQiTRhgQIKjAAAAzwIBAG5IZWxsb0FhIAMAU/clBNuvE91bSadnFF2xSOwSfLHHe5n94yDpv9ys0az740TXAwQmBAAEAg0AAQQBAgUABgIBBQQA9w0DBAINAAUCAAQFBCYzAAoJAAYABQwFCgYJBgUQBAD2DQQGDwUGBAMGAAQDJwQAAxAFBgYjBQwDAAQFBgMEAPAKBAYJCwYAAgoEAAMCBAUDCgNEAAAAAAABAAAAAAAnKLzEAQAAAAUAAAAGAIIEdGV4dAEGAIIEdGV4dLBU8Ua7AAAAAAAAAA=="
const update = "bG9ybwAAAAAAAAAAAAAAAC0ZfV0ABFUbAzUDASUD3KzRrPvjRNcUXbFI7BJ8scd7mf3jIOm/AQECAwECATQBAAAABQEAAAEABgEEAQIAAAUEdGV4dAAPAQQCAQADAdYBAgEFAgEDAAQDQWEg"

const decodedSnapshot = Base64.toUint8Array(snapshot)
const decodedUpdate = Base64.toUint8Array(update)

const doc = new LoroDoc()
doc.import(decodedSnapshot)
console.log("Imported snapshot")
console.log(doc.toJSON())

doc.import(decodedUpdate)
console.log("Imported update")

const res = doc.export({ mode: "snapshot" })
console.log("Exported")
